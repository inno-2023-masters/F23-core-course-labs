# Task 1

## app-python

```
 helm secrets install python ./app_python/ --values ./app_python/values.python.yml 
```

```
NAME: app-python
LAST DEPLOYED: Wed Dec 5 22:06:35 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services app-python)
  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")
  echo http://$NODE_IP:$NODE_PORT
removed './secrets.yaml.dec'
```

## app-go

```
helm secrets install go ./app_go/ --values ./app_go/values.go.yml
```

```
NAME: app-go
LAST DEPLOYED: Wed Dec 5 22:18:14 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services app-python)
  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")
  echo http://$NODE_IP:$NODE_PORT
removed './secrets.yaml.dec'
```

# Task 2

```
kubectl get po,sts,svc,pvc
```

```
NAME                                        READY   STATUS    RESTARTS       AGE
pod/app-python-0                        1/1     Running   0              75s
pod/app-python-app-1                        1/1     Running   0              75s
pod/go-app-2                        1/1     Running   0              75s
pod/python-app-python-0                     1/1     Running   0              3m14s
pod/python-app-python-1                     1/1     Running   0              3m14s
pod/python-app-python-2                     1/1     Running   0              3m14s
pod/vault-0                                 1/1     Running   5 (12m ago)    8d
pod/vault-agent-injector-5cd8b87c6c-hcw9q   1/1     Running   5 (99m ago)   8d

NAME                                 READY   AGE
statefulset.apps/go-app      3/3     76s
statefulset.apps/python-python-app   3/3     3m13s
statefulset.apps/vault               1/1     8d

NAME                               TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)             AGE
service/go-app             LoadBalancer   10.101.52.252    <pending>     10000:30545/TCP     86s
service/kubernetes                 ClusterIP      10.93.0.1        <none>        443/TCP             15d
service/python-app-python          LoadBalancer   10.102.65.81     <pending>     5000:30627/TCP      2m28s
service/vault                      ClusterIP      10.100.180.110   <none>        8200/TCP,8201/TCP   8d
service/vault-agent-injector-svc   ClusterIP      10.106.23.126    <none>        443/TCP             8d
service/vault-internal             ClusterIP      None             <none>        8200/TCP,8201/TCP   8d

NAME                                                             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/app-go-metric-app-go-0      Bound    pvc-1f39a14c-08b2-2cde-6c20-3d2ebd3536f1   6Mi        RWO            standard       17m
persistentvolumeclaim/app-go-metric-app-go-1      Bound    pvc-ba12e483-62d1-3ad0-46b8-21dec532ef51   6Mi        RWO            standard       17m
persistentvolumeclaim/app-go-metric-app-go-2      Bound    pvc-6f3ec7d5-5eb0-31bd-7b42-f462168d5138   6Mi        RWO            standard       17m
persistentvolumeclaim/app-python-metric-app-python-0   Bound    pvc-81d5bf15-1c32-79dc-5f3e-4d3158df47c5   6Mi        RWO            standard       17m
persistentvolumeclaim/app-python-metric-app-python-1   Bound    pvc-f46d705b-a325-2cf3-912a-64fc381ba451   6Mi        RWO            standard       17m
persistentvolumeclaim/app-python-metric-app-python-2   Bound    pvc-abffc362-24c3-6c36-93f2-16acd2881530   6Mi        RWO            standard       17m
```

## Visits

```
kubectl exec pod/demo-0 -- cat visits
```

app-go-0:

```
cat /proc/1/root/app/data/visits.txt
34
```
app-go-1

```
cat /proc/1/root/app/data/visits.txt
23
```
## Questions

* As evident, the visits to each pod vary because each pod has its own persistent volume and the LoadBalancer distributes requests among the pods.

* Ordering guarantees are not required for app-go (i.e goredirector) because all replicas operate independently and have the ability to function autonomously.

* Parallel pod management policy can be set in values.yaml in order to launch or terminate pods in parallel:

```
PodManagementPolicy: Parallel
```

# Bonus

Steps were applied for the go-app.

# Strategies:

Explore different update strategies:

- Rolling update strategy is a popular iterative approach where each pod is updated individually, commonly used in companies like Tinkoff.
- Canary update strategy updates a small number of pods while others remain with the old version, allowing developers to check their validity before updating all other pods, making it a good strategy for large projects.
- Recreate update strategy involves deactivating all outdated pods and creating new ones for the entire system, which may not be considered safe due to potential errors in the new pods.
- Blue/green deployment strategy involves creating a separate identical environment for the new version (green) and switching traffic between versions, similar to a feature flag for release.
- Ramped Slow Rollout strategy updates by creating new replicas while removing old ones, allowing control over the pace of the rollout.
- Best-Effort Controlled Rollout is an alternative solution to Ramped Slow Rollout that prioritizes speed but involves a trade-off between speed and risk.
- Shadow deployment strategy deploys a new version of an application without affecting end-users, suitable for real-time testing of a new version.
- A/B Testing involves dividing users into groups and updating one group to a new version while the other group stays with the old version, often used to test how users perceive new features, similar to the Canary strategy.