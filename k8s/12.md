# Kubernetes ConfigMaps

## Task 1


```python
def record_visit(): 
    with open('data/visits', 'r') as f:
        count = f.read()
        if count == '': 
            count = 0
        else: 
            count = int(count) 
    with open('data/visits', 'w') as f: 
        f.flush() 
        f.write(str(count + 1))
    return count 
```
![Moscow App](image-10.png)

![Visits](image-11.png)

## Task 2

```bash
docker-compose up

CONTAINER ID   IMAGE                                 COMMAND                  CREATED          STATUS          PORTS                                                                                                                                  NAMES
d056f60d5191   rinnatova/docker_lab:latest       "gunicorn -b 0.0.0.0…"   6 seconds ago    Up 4 seconds    0.0.0.0:5000->5000/tcp, :::5000->5000/tcp                                                                                              app_python
dbb7eeb81c85   rinnatova/docker_lab:latest       "gunicorn -b 0.0.0.0…"   6 seconds ago    Up 5 seconds    5000/tcp, 0.0.0.0:30000->30000/tcp, :::30000->30000/tcp                                                                              
```
docker-compose up

```bash
kubectl get po
NAME                                               READY   STATUS    RESTARTS   AGE
python-app-helm-87s53132-6325c                     1/1     Running   0          81s
```

```bash
kubectl exec python-app-helm-87s53132-6325c  -- cat /config.json
{
    "k1": "v1",
    "k2": "v2"
}

kubectl describe po python-app-helm-87s53132-6325c
Name:             python-app-helm-87s53132-6325c
Namespace:        default
Priority:         0
Service Account:  python-app-helm
Node:             minikube/192.168.49.2
Start Time:       Mon, 11 Dec 2023 22:23:35 +0300

...
    Readiness:  http-get http://:http/ delay=0s timeout=1s period=10s
    Environment:
      VAR:                V1
      PASSWORD:           <set to the key 'password' in secret 'db-user-pass'>          Optional: false
      USERNAME:           <set to the key 'username' in secret 'db-user-pass'>          Optional: false
      SOME-KEY:           <set to the key 'test' of config map 'config-entity'>         Optional: false
    Mounts:
...
```

```bash
kubectl exec python-app-helm-87s53132-6325c -- env | grep SOME
SOME-KEY=test
```

