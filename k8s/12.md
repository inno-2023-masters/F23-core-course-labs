## Mounted configs


- Since out container doesn't have `tar` or `cat` utilities in it, we had to use ephemeral container with  `kubectl debug` to ensure that volumes were mounted properly.

```
kubectl debug $POD --image alpine --stdin --tty --target app-go
```

- If `--target` is specified during launch of emphemeral container, they will share PIDs. Assuming that PID of the application is 1, original container root will be at `/proc/1/root`. However, in order to access it, our user should have same as the owner. Assumigng that the container is runing as non-root user, we need to create temporarily `debugger` user to access the container rootfs.

```
APP_PID=$(ps | grep app_go | head -n 1 | tr -s " " |  cut -f 2 -d" ") 
APP_UID=$(ls -n /proc | grep "$APP_PID"  | head -n 2 | tr -s " " | cut -d " " -f 3  | head -n 1)

addgroup -g "$APP_UID" debugger
adduser -HD -u "$APP_UID" -G debugger debugger
su debugger

cat /proc/1/root/app/config.json
```

```json
{
    "why": 42
}
```

## Bonus

- Environmental variables were successfully set up via configMap according to [documentation](https://kubernetes.io/docs/concepts/configuration/configmap/). However, printing them might not always be straightforward.
    - Since in production containers usually do not have shells or utilities like `printenv`, variable can not be obtained via command suggested in the task description
    - Ephemeral containers are usually used via `kubectl debug` to troubleshoot pod-specific issues, however they do not include container-specific environmental variables
    - `kubectl describe` can be used to view environmental variables, however it does not include those injected from the configMap
    - Another option is to temporarily include debug utilities to the container, however this option would either require additonal setitng of debug tag and reconfiguration.  
    

- `DEFAULT_REDIRECT_URL: https://google.com`

```
export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services app-go)
export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")

curl  http://$NODE_IP:$NODE_PORT
```

```
<a href="https://google.com">Found</a>.
```


## References

- https://kubernetes.io/docs/concepts/configuration/configmap/

- https://stackoverflow.com/questions/52583254/kubernetes-helm-files-get-and-variables
- https://carlos.mendible.com/2019/02/10/kubernetes-mount-file-pod-with-configmap/